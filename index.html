<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Gestão de Vendas</title>
    <style>
        :root {
            --primary: #4f46e5;
            --primary-light: #6366f1;
            --primary-dark: #4338ca;
            --secondary: #64748b;
            --success: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --background: #f8fafc;
            --surface: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --radius: 0.5rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1rem;
            background: var(--surface);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .dashboard-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--text);
            letter-spacing: -0.025em;
        }

        .navigation {
            display: flex;
            gap: 0.5rem;
            background: var(--surface);
            padding: 0.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .nav-button {
            padding: 0.75rem 1.5rem;
            border: none;
            background: transparent;
            color: var(--text-light);
            font-weight: 500;
            border-radius: calc(var(--radius) - 0.25rem);
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-button:hover {
            color: var(--primary);
            background: #f1f5f9;
        }

        .nav-button.active {
            background: var(--primary);
            color: white;
        }

        .card {
            background: var(--surface);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
        }

        .card-body {
            padding: 1.5rem;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text);
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: all 0.2s;
            color: var(--text);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 1rem;
            background-color: var(--surface);
            cursor: pointer;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            font-weight: 500;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            opacity: 0.9;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            opacity: 0.9;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 1rem 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: var(--surface);
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .stat-title {
            font-size: 0.875rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text);
        }

        .stat-change {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            margin-top: 0.5rem;
            font-size: 0.875rem;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--surface);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: #f8fafc;
            font-weight: 500;
            color: var(--text-light);
        }

        .filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--surface);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .badge-success {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
            }

            .navigation {
                width: 100%;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="dashboard-header">
            <h1 class="dashboard-title">Dashboard de Gestão de Vendas</h1>
            <nav class="navigation">
                <button class="nav-button active" onclick="showTab('dashboard')">Dashboard</button>
                <button class="nav-button" onclick="showTab('cadastros')">Cadastros</button>
                <button class="nav-button" onclick="showTab('vendas')">Vendas</button>
                <button class="nav-button" onclick="showTab('relatorios')">Relatórios</button>
            </nav>
        </header>

        <!-- Dashboard -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-title">Total de Vendas</div>
                    <div class="stat-value" id="totalVendasDash">R$ 0,00</div>
                    <div class="stat-change positive">
                        <span>↑ 12%</span>
                        <span>vs. último mês</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">Comissões</div>
                    <div class="stat-value" id="totalComissoesDash">R$ 0,00</div>
                    <div class="stat-change positive">
                        <span>↑ 8%</span>
                        <span>vs. último mês</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">Vendedores Ativos</div>
                    <div class="stat-value" id="totalVendedores">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">Serviços Ativos</div>
                    <div class="stat-value" id="totalServicos">0</div>
                </div>
            </div>

            <div class="grid">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Vendas por Serviço</h2>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="vendasServicoChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Desempenho dos Vendedores</h2>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="desempenhoVendedoresChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cadastros -->
        <div id="cadastros" class="tab-content">
            <div class="grid">
                <!-- Cadastro de Vendedor -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Cadastro de Vendedor</h2>
                    </div>
                    <div class="card-body">
                        <form id="vendedorForm">
                            <div class="form-group">
                                <label class="form-label">Nome do Vendedor</label>
                                <input type="text" id="nomeVendedor" class="form-input" placeholder="Digite o nome do vendedor" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" id="emailVendedor" class="form-input" placeholder="Digite o email do vendedor" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Telefone</label>
                                <input type="tel" id="telefoneVendedor" class="form-input" placeholder="Digite o telefone do vendedor">
                            </div>
                            <button type="submit" class="btn btn-primary">Cadastrar Vendedor</button>
                        </form>
                        <div id="listaVendedores" class="mt-4">
                            <h3>Vendedores Cadastrados</h3>
                            <ul id="vendedoresList" class="list-group"></ul>
                        </div>
                    </div>
                </div>

                <!-- Cadastro de Serviço -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Cadastro de Serviço</h2>
                    </div>
                    <div class="card-body">
                        <form id="servicoForm">
                            <div class="form-group">
                                <label class="form-label">Nome do Serviço</label>
                                <input type="text" id="nomeServico" class="form-input" placeholder="Digite o nome do serviço" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Categoria</label>
                                <input type="text" id="categoriaServico" class="form-input" placeholder="Digite a categoria do serviço" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Tipo de Comissão</label>
                                <select id="tipoComissao" class="form-select" required>
                                    <option value="fixa">Fixa</option>
                                    <option value="porcentagem">Porcentagem</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Cadastrar Serviço</button>
                        </form>
                        <div id="listaServicos" class="mt-4">
                            <h3>Serviços Cadastrados</h3>
                            <ul id="servicosList" class="list-group"></ul>
                        </div>
                    </div>
                </div>

                <!-- Cadastro de Empresa Parceira -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Cadastro de Empresa Parceira</h2>
                    </div>
                    <div class="card-body">
                        <form id="empresaForm">
                            <div class="form-group">
                                <label class="form-label">Nome da Empresa</label>
                                <input type="text" id="nomeEmpresa" class="form-input" placeholder="Digite o nome da empresa" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Categoria</label>
                                <input type="text" id="categoriaEmpresa" class="form-input" placeholder="Digite a categoria da empresa" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Cadastrar Empresa</button>
                        </form>
                        <div id="listaEmpresas" class="mt-4">
                            <h3>Empresas Parceiras Cadastradas</h3>
                            <ul id="empresasList" class="list-group"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vendas -->
        <div id="vendas" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Registrar Venda</h2>
                </div>
                <div class="card-body">
                    <form id="vendaForm">
                        <div class="form-group">
                            <label class="form-label">Vendedor</label>
                            <select id="vendedorVenda" class="form-select" required>
                                <option value="">Selecione um vendedor</option>
                                <!-- As opções serão preenchidas dinamicamente via JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Serviço</label>
                            <select id="servicoVenda" class="form-select" required>
                                <option value="">Selecione um serviço</option>
                                <!-- As opções serão preenchidas dinamicamente via JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Data da Venda</label>
                            <input type="date" id="dataVenda" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Nome do Cliente</label>
                            <input type="text" id="nomeCliente" class="form-input" placeholder="Digite o nome do cliente" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Empresa Parceira</label>
                            <select id="empresaParceira" class="form-select" required>
                                <option value="">Selecione uma empresa parceira</option>
                                <!-- As opções serão preenchidas dinamicamente via JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Valor da Venda</label>
                            <input type="text" id="valorVenda" class="form-input" placeholder="Digite o valor da venda" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Valor a Receber</label>
                            <input type="text" id="valorReceber" class="form-input" placeholder="Digite o valor a receber" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Comissão</label>
                            <input type="text" id="comissao" class="form-input" placeholder="Digite a comissão" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Registrar Venda</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Relatórios -->
        <div id="relatorios" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Relatório de Vendas</h2>
                    <button class="btn btn-secondary" onclick="exportarRelatorioPDF()">Exportar PDF</button>
                    <button class="btn btn-secondary" onclick="exportarRelatorioExcel()">Exportar Excel</button>
                </div>
                <div class="card-body">
                    <div class="filters">
                        <div class="form-group">
                            <label class="form-label">Data Inicial</label>
                            <input type="date" id="dataInicial" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Data Final</label>
                            <input type="date" id="dataFinal" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Vendedor</label>
                            <select id="filtroVendedor" class="form-select">
                                <option value="">Todos</option>
                                <!-- As opções serão preenchidas dinamicamente via JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Colunas</label>
                            <select id="filtroColunas" class="form-select" multiple>
                                <option value="data">Data da Venda</option>
                                <option value="vendedor">Nome do Vendedor</option>
                                <option value="servico">Serviço Vendido</option>
                                <option value="tipoComissao">Tipo de Comissão</option>
                                <option value="nomeCliente">Nome do Cliente</option>
                                <option value="empresaParceira">Empresa Parceira</option>
                                <option value="comissao">Valor da Comissão</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="filtrarRelatorio()">Filtrar</button>
                    </div>
                    <table id="tabelaRelatorio">
                        <thead>
                            <tr>
                                <!-- As colunas serão preenchidas dinamicamente via JavaScript -->
                            </tr>
                        </thead>
                        <tbody>
                            <!-- As linhas da tabela serão preenchidas dinamicamente via JavaScript -->
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="6" style="text-align: right;"><strong>Total da Comissão:</strong></td>
                                <td id="totalComissaoRelatorio">R$ 0,00</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script>
        const { jsPDF } = window.jspdf;

        let dados = {
            vendas: [],
            vendedores: [],
            servicos: [],
            empresasParceiras: []
        };

        // Função para alternar entre as abas
        function showTab(tabId) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            document.getElementById(tabId).classList.add('active');

            const buttons = document.querySelectorAll('.nav-button');
            buttons.forEach(button => button.classList.remove('active'));
            document.querySelector(`[onclick="showTab('${tabId}')"]`).classList.add('active');
        }

        // Inicializa a aba "Dashboard" como ativa ao carregar a página
        document.addEventListener('DOMContentLoaded', function () {
            showTab('dashboard');
            atualizarOpcoesVendedores();
            atualizarOpcoesServicos();
            atualizarOpcoesEmpresas();
        });

        // Função para atualizar as opções de vendedores
        function atualizarOpcoesVendedores() {
            const selectVendedor = document.getElementById('vendedorVenda');
            selectVendedor.innerHTML = '<option value="">Selecione um vendedor</option>';
            dados.vendedores.forEach(vendedor => {
                const option = document.createElement('option');
                option.value = vendedor.id;
                option.textContent = vendedor.nome;
                selectVendedor.appendChild(option);
            });

            const filtroVendedor = document.getElementById('filtroVendedor');
            filtroVendedor.innerHTML = '<option value="">Todos</option>';
            dados.vendedores.forEach(vendedor => {
                const option = document.createElement('option');
                option.value = vendedor.id;
                option.textContent = vendedor.nome;
                filtroVendedor.appendChild(option);
            });
        }

        // Função para atualizar as opções de serviços
        function atualizarOpcoesServicos() {
            const selectServico = document.getElementById('servicoVenda');
            selectServico.innerHTML = '<option value="">Selecione um serviço</option>';
            dados.servicos.forEach(servico => {
                const option = document.createElement('option');
                option.value = servico.id;
                option.textContent = servico.nome;
                selectServico.appendChild(option);
            });
        }

        // Função para atualizar as opções de empresas parceiras
        function atualizarOpcoesEmpresas() {
            const selectEmpresa = document.getElementById('empresaParceira');
            selectEmpresa.innerHTML = '<option value="">Selecione uma empresa parceira</option>';
            dados.empresasParceiras.forEach(empresa => {
                const option = document.createElement('option');
                option.value = empresa.id;
                option.textContent = empresa.nome;
                selectEmpresa.appendChild(option);
            });
        }

        // Função para cadastrar vendedor
        document.getElementById('vendedorForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const nomeVendedor = document.getElementById('nomeVendedor').value;
            const emailVendedor = document.getElementById('emailVendedor').value;
            const telefoneVendedor = document.getElementById('telefoneVendedor').value;

            const novoVendedor = {
                id: dados.vendedores.length + 1,
                nome: nomeVendedor,
                email: emailVendedor,
                telefone: telefoneVendedor
            };

            dados.vendedores.push(novoVendedor);
            atualizarListaVendedores();
            atualizarOpcoesVendedores();
            alert('Vendedor cadastrado com sucesso!');
        });

        // Função para atualizar a lista de vendedores
        function atualizarListaVendedores() {
            const listaVendedores = document.getElementById('vendedoresList');
            listaVendedores.innerHTML = '';

            dados.vendedores.forEach(vendedor => {
                const li = document.createElement('li');
                li.className = 'list-group-item';
                li.innerHTML = `
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <strong>${vendedor.nome}</strong><br>
                            <small>${vendedor.email} - ${vendedor.telefone}</small>
                        </div>
                        <div>
                            <button class="btn btn-sm btn-secondary" onclick="editarVendedor(${vendedor.id})">Editar</button>
                            <button class="btn btn-sm btn-danger" onclick="excluirVendedor(${vendedor.id})">Excluir</button>
                        </div>
                    </div>
                `;
                listaVendedores.appendChild(li);
            });
        }

        // Função para editar vendedor
        function editarVendedor(id) {
            const vendedor = dados.vendedores.find(v => v.id === id);
            if (vendedor) {
                document.getElementById('nomeVendedor').value = vendedor.nome;
                document.getElementById('emailVendedor').value = vendedor.email;
                document.getElementById('telefoneVendedor').value = vendedor.telefone;

                const form = document.getElementById('vendedorForm');
                form.onsubmit = function (e) {
                    e.preventDefault();
                    vendedor.nome = document.getElementById('nomeVendedor').value;
                    vendedor.email = document.getElementById('emailVendedor').value;
                    vendedor.telefone = document.getElementById('telefoneVendedor').value;
                    atualizarListaVendedores();
                    atualizarOpcoesVendedores();
                    alert('Vendedor atualizado com sucesso!');
                };
            }
        }

        // Função para excluir vendedor
        function excluirVendedor(id) {
            dados.vendedores = dados.vendedores.filter(v => v.id !== id);
            atualizarListaVendedores();
            atualizarOpcoesVendedores();
            alert('Vendedor excluído com sucesso!');
        }

        // Função para cadastrar serviço
        document.getElementById('servicoForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const nomeServico = document.getElementById('nomeServico').value;
            const categoriaServico = document.getElementById('categoriaServico').value;
            const tipoComissao = document.getElementById('tipoComissao').value;

            const novoServico = {
                id: dados.servicos.length + 1,
                nome: nomeServico,
                categoria: categoriaServico,
                tipoComissao: tipoComissao
            };

            dados.servicos.push(novoServico);
            atualizarListaServicos();
            atualizarOpcoesServicos();
            alert('Serviço cadastrado com sucesso!');
        });

        // Função para atualizar a lista de serviços
        function atualizarListaServicos() {
            const listaServicos = document.getElementById('servicosList');
            listaServicos.innerHTML = '';

            dados.servicos.forEach(servico => {
                const li = document.createElement('li');
                li.className = 'list-group-item';
                li.innerHTML = `
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <strong>${servico.nome}</strong><br>
                            <small>Categoria: ${servico.categoria} - Tipo de Comissão: ${servico.tipoComissao}</small>
                        </div>
                        <div>
                            <button class="btn btn-sm btn-secondary" onclick="editarServico(${servico.id})">Editar</button>
                            <button class="btn btn-sm btn-danger" onclick="excluirServico(${servico.id})">Excluir</button>
                        </div>
                    </div>
                `;
                listaServicos.appendChild(li);
            });
        }

        // Função para editar serviço
        function editarServico(id) {
            const servico = dados.servicos.find(s => s.id === id);
            if (servico) {
                document.getElementById('nomeServico').value = servico.nome;
                document.getElementById('categoriaServico').value = servico.categoria;
                document.getElementById('tipoComissao').value = servico.tipoComissao;

                const form = document.getElementById('servicoForm');
                form.onsubmit = function (e) {
                    e.preventDefault();
                    servico.nome = document.getElementById('nomeServico').value;
                    servico.categoria = document.getElementById('categoriaServico').value;
                    servico.tipoComissao = document.getElementById('tipoComissao').value;
                    atualizarListaServicos();
                    atualizarOpcoesServicos();
                    alert('Serviço atualizado com sucesso!');
                };
            }
        }

        // Função para excluir serviço
        function excluirServico(id) {
            dados.servicos = dados.servicos.filter(s => s.id !== id);
            atualizarListaServicos();
            atualizarOpcoesServicos();
            alert('Serviço excluído com sucesso!');
        }

        // Função para cadastrar empresa parceira
        document.getElementById('empresaForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const nomeEmpresa = document.getElementById('nomeEmpresa').value;
            const categoriaEmpresa = document.getElementById('categoriaEmpresa').value;

            const novaEmpresa = {
                id: dados.empresasParceiras.length + 1,
                nome: nomeEmpresa,
                categoria: categoriaEmpresa
            };

            dados.empresasParceiras.push(novaEmpresa);
            atualizarListaEmpresas();
            atualizarOpcoesEmpresas();
            alert('Empresa cadastrada com sucesso!');
        });

        // Função para atualizar a lista de empresas parceiras
        function atualizarListaEmpresas() {
            const listaEmpresas = document.getElementById('empresasList');
            listaEmpresas.innerHTML = '';

            dados.empresasParceiras.forEach(empresa => {
                const li = document.createElement('li');
                li.className = 'list-group-item';
                li.innerHTML = `
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <strong>${empresa.nome}</strong><br>
                            <small>Categoria: ${empresa.categoria}</small>
                        </div>
                        <div>
                            <button class="btn btn-sm btn-secondary" onclick="editarEmpresa(${empresa.id})">Editar</button>
                            <button class="btn btn-sm btn-danger" onclick="excluirEmpresa(${empresa.id})">Excluir</button>
                        </div>
                    </div>
                `;
                listaEmpresas.appendChild(li);
            });
        }

        // Função para editar empresa parceira
        function editarEmpresa(id) {
            const empresa = dados.empresasParceiras.find(e => e.id === id);
            if (empresa) {
                document.getElementById('nomeEmpresa').value = empresa.nome;
                document.getElementById('categoriaEmpresa').value = empresa.categoria;

                const form = document.getElementById('empresaForm');
                form.onsubmit = function (e) {
                    e.preventDefault();
                    empresa.nome = document.getElementById('nomeEmpresa').value;
                    empresa.categoria = document.getElementById('categoriaEmpresa').value;
                    atualizarListaEmpresas();
                    atualizarOpcoesEmpresas();
                    alert('Empresa atualizada com sucesso!');
                };
            }
        }

        // Função para excluir empresa parceira
        function excluirEmpresa(id) {
            dados.empresasParceiras = dados.empresasParceiras.filter(e => e.id !== id);
            atualizarListaEmpresas();
            atualizarOpcoesEmpresas();
            alert('Empresa excluída com sucesso!');
        }

        // Função para registrar venda
        document.getElementById('vendaForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const vendedorId = document.getElementById('vendedorVenda').value;
            const servicoId = document.getElementById('servicoVenda').value;
            const dataVenda = document.getElementById('dataVenda').value;
            const nomeCliente = document.getElementById('nomeCliente').value;
            const empresaParceiraId = document.getElementById('empresaParceira').value;
            const valorVenda = parseFloat(document.getElementById('valorVenda').value.replace(',', '.'));
            const valorReceber = parseFloat(document.getElementById('valorReceber').value.replace(',', '.'));
            const comissao = parseFloat(document.getElementById('comissao').value.replace(',', '.'));

            const vendedor = dados.vendedores.find(v => v.id == vendedorId);
            const servico = dados.servicos.find(s => s.id == servicoId);
            const empresaParceira = dados.empresasParceiras.find(e => e.id == empresaParceiraId);

            if (!vendedor || !servico || !empresaParceira) {
                alert('Por favor, selecione um vendedor, serviço e empresa parceira válidos.');
                return;
            }

            const novaVenda = {
                id: dados.vendas.length + 1,
                vendedor: vendedor.nome,
                servico: servico.nome,
                data: dataVenda,
                nomeCliente: nomeCliente,
                empresaParceira: empresaParceira.nome,
                valorVenda: valorVenda,
                valorReceber: valorReceber,
                comissao: comissao,
                tipoComissao: servico.tipoComissao
            };

            dados.vendas.push(novaVenda);
            alert('Venda registrada com sucesso!');
            atualizarDashboard();
        });

        // Função para filtrar relatório
        function filtrarRelatorio() {
            const dataInicial = document.getElementById('dataInicial').value;
            const dataFinal = document.getElementById('dataFinal').value;
            const vendedorId = document.getElementById('filtroVendedor').value;
            const colunasSelecionadas = Array.from(document.getElementById('filtroColunas').selectedOptions).map(option => option.value);

            const vendasFiltradas = dados.vendas.filter(venda => {
                const dataVenda = new Date(venda.data);
                const dataInicialFiltro = new Date(dataInicial);
                const dataFinalFiltro = new Date(dataFinal);

                const filtroData = (!dataInicial || dataVenda >= dataInicialFiltro) && (!dataFinal || dataVenda <= dataFinalFiltro);
                const filtroVendedor = !vendedorId || venda.vendedor === dados.vendedores.find(v => v.id == vendedorId).nome;

                return filtroData && filtroVendedor;
            });

            const colunas = {
                data: 'Data da Venda',
                vendedor: 'Nome do Vendedor',
                servico: 'Serviço Vendido',
                tipoComissao: 'Tipo de Comissão',
                nomeCliente: 'Nome do Cliente',
                empresaParceira: 'Empresa Parceira',
                comissao: 'Valor da Comissão'
            };

            const thead = document.querySelector('#tabelaRelatorio thead');
            const tbody = document.querySelector('#tabelaRelatorio tbody');

            thead.innerHTML = '';
            tbody.innerHTML = '';

            const headerRow = document.createElement('tr');
            colunasSelecionadas.forEach(coluna => {
                const th = document.createElement('th');
                th.textContent = colunas[coluna];
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);

            let totalComissao = 0;

            vendasFiltradas.forEach(venda => {
                const row = document.createElement('tr');
                colunasSelecionadas.forEach(coluna => {
                    const td = document.createElement('td');
                    td.textContent = venda[coluna];
                    row.appendChild(td);
                });
                tbody.appendChild(row);

                if (venda.tipoComissao === 'fixa') {
                    totalComissao += venda.comissao;
                } else if (venda.tipoComissao === 'porcentagem') {
                    totalComissao += venda.valorReceber * (venda.comissao / 100);
                }
            });

            document.getElementById('totalComissaoRelatorio').textContent = `R$ ${totalComissao.toFixed(2)}`;
        }

        // Função para exportar relatório em PDF
        function exportarRelatorioPDF() {
            const colunasSelecionadas = Array.from(document.getElementById('filtroColunas').selectedOptions).map(option => option.value);
            const colunas = {
                data: 'Data da Venda',
                vendedor: 'Nome do Vendedor',
                servico: 'Serviço Vendido',
                tipoComissao: 'Tipo de Comissão',
                nomeCliente: 'Nome do Cliente',
                empresaParceira: 'Empresa Parceira',
                comissao: 'Valor da Comissão'
            };

            const headers = colunasSelecionadas.map(coluna => colunas[coluna]);
            const data = [];

            document.querySelectorAll('#tabelaRelatorio tbody tr').forEach(row => {
                const rowData = [];
                row.querySelectorAll('td').forEach(cell => {
                    rowData.push(cell.textContent);
                });
                data.push(rowData);
            });

            const doc = new jsPDF();
            doc.autoTable({
                head: [headers],
                body: data,
            });

            doc.save('relatorio_vendas.pdf');
        }

        // Função para exportar relatório em Excel
        function exportarRelatorioExcel() {
            const colunasSelecionadas = Array.from(document.getElementById('filtroColunas').selectedOptions).map(option => option.value);
            const colunas = {
                data: 'Data da Venda',
                vendedor: 'Nome do Vendedor',
                servico: 'Serviço Vendido',
                tipoComissao: 'Tipo de Comissão',
                nomeCliente: 'Nome do Cliente',
                empresaParceira: 'Empresa Parceira',
                comissao: 'Valor da Comissão'
            };

            const headers = colunasSelecionadas.map(coluna => colunas[coluna]);
            const data = [];

            document.querySelectorAll('#tabelaRelatorio tbody tr').forEach(row => {
                const rowData = {};
                row.querySelectorAll('td').forEach((cell, index) => {
                    rowData[headers[index]] = cell.textContent;
                });
                data.push(rowData);
            });

            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Relatório de Vendas');
            XLSX.writeFile(wb, 'relatorio_vendas.xlsx');
        }

        // Função para atualizar o dashboard
        function atualizarDashboard() {
            atualizarTotalVendas();
            atualizarComissoes();
            atualizarVendedoresAtivos();
            atualizarServicosAtivos();
            atualizarGraficoVendasPorServico();
            atualizarGraficoDesempenhoVendedores();
            atualizarGraficoVendasPorCategoria();
            atualizarGraficoDesempenhoPorVendedor();
            atualizarOutrosPainéis();
        }

        // Função para atualizar o total de vendas
        function atualizarTotalVendas() {
            const totalVendas = dados.vendas.reduce((total, venda) => total + venda.valorVenda, 0);
            document.getElementById('totalVendasDash').textContent = `R$ ${totalVendas.toFixed(2)}`;
        }

        // Função para atualizar o total de comissões
        function atualizarComissoes() {
            const totalComissoes = dados.vendas.reduce((total, venda) => {
                if (venda.tipoComissao === 'fixa') {
                    return total + venda.comissao;
                } else if (venda.tipoComissao === 'porcentagem') {
                    return total + (venda.valorReceber * (venda.comissao / 100));
                }
                return total;
            }, 0);
            document.getElementById('totalComissoesDash').textContent = `R$ ${totalComissoes.toFixed(2)}`;
        }

        // Função para atualizar o total de vendedores ativos
        function atualizarVendedoresAtivos() {
            const totalVendedores = dados.vendedores.length;
            document.getElementById('totalVendedores').textContent = totalVendedores;
        }

        // Função para atualizar o total de serviços ativos
        function atualizarServicosAtivos() {
            const totalServicos = dados.servicos.length;
            document.getElementById('totalServicos').textContent = totalServicos;
        }

        // Função para atualizar o gráfico de vendas por serviço
        function atualizarGraficoVendasPorServico() {
            const vendasPorServico = dados.servicos.map(servico => {
                return dados.vendas.filter(venda => venda.servico === servico.nome).length;
            });

            vendasServicoChart.data.datasets[0].data = vendasPorServico;
            vendasServicoChart.update();
        }

        // Função para atualizar o gráfico de desempenho dos vendedores
        function atualizarGraficoDesempenhoVendedores() {
            const desempenhoVendedores = dados.vendedores.map(vendedor => {
                return dados.vendas.filter(venda => venda.vendedor === vendedor.nome).length;
            });

            desempenhoVendedoresChart.data.datasets[0].data = desempenhoVendedores;
            desempenhoVendedoresChart.update();
        }

        // Função para atualizar o gráfico de vendas por categoria
        function atualizarGraficoVendasPorCategoria() {
            const vendasPorCategoria = dados.servicos.map(servico => {
                return dados.vendas.filter(venda => venda.servico === servico.nome).length;
            });

            vendasCategoriaChart.data.datasets[0].data = vendasPorCategoria;
            vendasCategoriaChart.update();
        }

        // Função para atualizar o gráfico de desempenho por vendedor
        function atualizarGraficoDesempenhoPorVendedor() {
            const desempenhoPorVendedor = dados.vendedores.map(vendedor => {
                return dados.vendas.filter(venda => venda.vendedor === vendedor.nome).length;
            });

            desempenhoPorVendedorChart.data.labels = dados.vendedores.map(vendedor => vendedor.nome);
            desempenhoPorVendedorChart.data.datasets[0].data = desempenhoPorVendedor;
            desempenhoPorVendedorChart.update();
        }

        // Função para atualizar outros painéis
        function atualizarOutrosPainéis() {
            // Adicione aqui a lógica para atualizar outros painéis
        }

        // Inicialização dos gráficos
        const vendasServicoChart = new Chart(document.getElementById('vendasServicoChart'), {
            type: 'bar',
            data: {
                labels: ['Consultoria', 'Treinamento', 'Suporte Técnico'],
                datasets: [{
                    label: 'Vendas',
                    data: [0, 0, 0],
                    backgroundColor: 'rgba(79, 70, 229, 0.2)',
                    borderColor: 'rgba(79, 70, 229, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        const desempenhoVendedoresChart = new Chart(document.getElementById('desempenhoVendedoresChart'), {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Desempenho',
                    data: [],
                    fill: false,
                    borderColor: 'rgba(79, 70, 229, 1)',
                    tension: 0.1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        const vendasCategoriaChart = new Chart(document.getElementById('vendasCategoriaChart'), {
            type: 'pie',
            data: {
                labels: ['Consultoria', 'Treinamento', 'Suporte Técnico'],
                datasets: [{
                    label: 'Vendas por Categoria',
                    data: [0, 0, 0],
                    backgroundColor: [
                        'rgba(79, 70, 229, 0.2)',
                        'rgba(34, 197, 94, 0.2)',
                        'rgba(239, 68, 68, 0.2)'
                    ],
                    borderColor: [
                        'rgba(79, 70, 229, 1)',
                        'rgba(34, 197, 94, 1)',
                        'rgba(239, 68, 68, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Vendas por Categoria'
                    }
                }
            }
        });

        const desempenhoPorVendedorChart = new Chart(document.getElementById('desempenhoPorVendedorChart'), {
            type: 'bar',
            data: {
                labels: [],
                datasets: [{
                    label: 'Vendas',
                    data: [],
                    backgroundColor: 'rgba(79, 70, 229, 0.2)',
                    borderColor: 'rgba(79, 70, 229, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
</body>
</html>
