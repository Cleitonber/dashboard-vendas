<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Gestão de Vendas</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="dashboard-header">
            <h1 class="dashboard-title">Dashboard de Gestão de Vendas</h1>
            <nav class="navigation">
                <button class="nav-button active" onclick="showTab('dashboard')">Dashboard</button>
                <button class="nav-button" onclick="showTab('cadastros')">Cadastros</button>
                <button class="nav-button" onclick="showTab('vendas')">Vendas</button>
                <button class="nav-button" onclick="showTab('relatorios')">Relatórios</button>
            </nav>
        </header>

        <!-- Dashboard -->
        <div id="dashboard" class="tab-content active">
            <!-- Conteúdo do Dashboard -->
        </div>

        <!-- Cadastros -->
        <div id="cadastros" class="tab-content">
            <!-- Conteúdo de Cadastros -->
        </div>

        <!-- Vendas -->
        <div id="vendas" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Registrar Venda</h2>
                </div>
                <div class="card-body">
                    <form id="vendaForm">
                        <div class="form-group">
                            <label class="form-label">Vendedor</label>
                            <select id="vendedorVenda" class="form-select" required>
                                <option value="">Selecione um vendedor</option>
                                <!-- As opções serão preenchidas dinamicamente via JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Serviço</label>
                            <select id="servicoVenda" class="form-select" required>
                                <option value="">Selecione um serviço</option>
                                <!-- As opções serão preenchidas dinamicamente via JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Data da Venda</label>
                            <input type="text" id="dataVenda" class="form-input" placeholder="DD/MM/AAAA" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Nome do Cliente</label>
                            <input type="text" id="nomeCliente" class="form-input" placeholder="Digite o nome do cliente" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Empresa Parceira</label>
                            <select id="empresaParceira" class="form-select" required>
                                <option value="">Selecione uma empresa parceira</option>
                                <!-- As opções serão preenchidas dinamicamente via JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Valor da Venda</label>
                            <input type="text" id="valorVenda" class="form-input" placeholder="R$ 0,00" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Valor a Receber</label>
                            <input type="text" id="valorReceber" class="form-input" placeholder="R$ 0,00" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Comissão</label>
                            <input type="text" id="comissao" class="form-input" placeholder="0,00" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Registrar Venda</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Relatórios -->
        <div id="relatorios" class="tab-content">
            <!-- Conteúdo de Relatórios -->
        </div>
    </div>

    <!-- Scripts do Firebase e integração com o formulário -->
    <script type="module">
        // Importações do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js";
        import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js";

        // Configuração do Firebase (substitua com suas credenciais)
        const firebaseConfig = {
            apiKey: "AIzaSyBjTJBsddXjGr3Fpb5YsLs7PbCOZQN3fQU",
            authDomain: "dashboard-vendas-dfa67.firebaseapp.com",
            projectId: "dashboard-vendas-dfa67",
            storageBucket: "dashboard-vendas-dfa67.firebasestorage.app",
            messagingSenderId: "817829195288",
            appId: "1:817829195288:web:1f95eac6d60573d6a2dd6d",
            measurementId: "G-YXPS1SKYMM"
        };

        // Inicializa o Firebase
        const app = initializeApp(firebaseConfig);

        // Inicializa o Realtime Database
        const database = getDatabase(app);

        // Função para registrar uma venda no Firebase
        function registrarVenda(venda) {
            const vendasRef = ref(database, 'vendas');
            push(vendasRef, venda)
                .then(() => {
                    alert('Venda registrada com sucesso!');
                    limparCamposVenda(); // Limpa os campos do formulário após o registro
                })
                .catch((error) => {
                    console.error('Erro ao registrar venda:', error);
                    alert('Erro ao registrar venda. Tente novamente.');
                });
        }

        // Função para limpar os campos do formulário de venda
        function limparCamposVenda() {
            document.getElementById('vendedorVenda').value = '';
            document.getElementById('servicoVenda').value = '';
            document.getElementById('dataVenda').value = '';
            document.getElementById('nomeCliente').value = '';
            document.getElementById('empresaParceira').value = '';
            document.getElementById('valorVenda').value = '';
            document.getElementById('valorReceber').value = '';
            document.getElementById('comissao').value = '';
        }

        // Captura o envio do formulário de venda
        document.getElementById('vendaForm').addEventListener('submit', function (e) {
            e.preventDefault(); // Impede o recarregamento da página

            // Cria um objeto com os dados da venda
            const venda = {
                vendedor: document.getElementById('vendedorVenda').value,
                servico: document.getElementById('servicoVenda').value,
                data: document.getElementById('dataVenda').value,
                nomeCliente: document.getElementById('nomeCliente').value,
                empresaParceira: document.getElementById('empresaParceira').value,
                valorVenda: parseFloat(document.getElementById('valorVenda').value.replace(/[^0-9,]/g, '').replace(',', '.')),
                valorReceber: parseFloat(document.getElementById('valorReceber').value.replace(/[^0-9,]/g, '').replace(',', '.')),
                comissao: parseFloat(document.getElementById('comissao').value.replace(/[^0-9,]/g, '').replace(',', '.'))
            };

            // Registra a venda no Firebase
            registrarVenda(venda);
        });
    </script>

    <!-- Scripts do projeto -->
    <script src="scripts.js"></script>
</body>
</html>
